(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{750:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",function(){return o}),n.d(t,"default",function(){return m});n(10),n(11),n(7),n(13),n(12),n(0);var a=n(104),i=n(755),c=n(5),l=n(65),s=n(101);n(67);var o={},r={_frontmatter:o},p=i.a;function m(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,i={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,["components"]);return Object(a.c)(p,Object.assign({},r,n,{components:t,mdxType:"MDXLayout"}),Object(a.c)("h1",null,"Adding API Classes"),Object(a.c)("p",null,"There are three main stages to adding a API class:"),Object(a.c)("ol",null,Object(a.c)("li",{parentName:"ol"},"Definition"),Object(a.c)("li",{parentName:"ol"},"Resolution"),Object(a.c)("li",{parentName:"ol"},"Invocation")),Object(a.c)("h2",null,"Definition"),Object(a.c)("p",null,"Within the ",Object(a.c)("inlineCode",{parentName:"p"},"src/Services/")," directory you should find a number of files. Most notable for us is the ",Object(a.c)("inlineCode",{parentName:"p"},"Service.ts")," and ",Object(a.c)("inlineCode",{parentName:"p"},"Services.ts")," files."),Object(a.c)(c.i,{mb:2,mdxType:"Flash"},Object(a.c)(l.c,{mdxType:"IssueOpenedIcon"})," ",Object(a.c)(c.l,{href:"https://github.com/xedi/sdk-js/issues/24",mdxType:"Link"},"[RFC] Rename `Services` to `API` to more accurately reflect what they are")),Object(a.c)("p",null,Object(a.c)("inlineCode",{parentName:"p"},"Service.ts"),' is the abstract class from which all our "Service" classes extend. It is responsible for the construction of the class, for handling the ',Object(a.c)(c.l,{href:"architecture/events",mdxType:"Link"},"classes events"),", and holding memory references to the ",Object(a.c)(c.l,{href:"architecture/configuration",mdxType:"Link"},"config bag")," and the ",Object(a.c)(c.l,{href:"architecture/http_requests",mdxType:"Link"},"HTTP client"),"."),Object(a.c)("p",null,"Within ",Object(a.c)("inlineCode",{parentName:"p"},"src/Services")," create a new file with the same name as the entity it will host. For example, ",Object(a.c)("inlineCode",{parentName:"p"},"Example.ts")," should look like this:"),Object(a.c)("pre",null,Object(a.c)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),"import Service from  './Service';\n\n\n/**\n * Example class\n */\nclass Example extends Service\n{\n}\n\nexport default Example;\n")),Object(a.c)("h2",null,"Resolution"),Object(a.c)("p",null,"Remember ",Object(a.c)("inlineCode",{parentName:"p"},"src/Services/Services.ts"),"? This is the first step of building the resolution root for our new class.\n",Object(a.c)("inlineCode",{parentName:"p"},"Services.ts"),' exports a TypeScript namespace, which allows use to easily import all our "Services" into our main class.'),Object(a.c)("p",null,'Firstly, import your newly created "Service" class.'),Object(a.c)("pre",null,Object(a.c)("code",Object.assign({parentName:"pre"},{className:"language-diff"}),"import Accounts from './Accounts';\n-\n+ import Example from './Example';\n+\n")),Object(a.c)("p",null,"Then, you should add the imported class to the end of the ",Object(a.c)("inlineCode",{parentName:"p"},"export")," object."),Object(a.c)("pre",null,Object(a.c)("code",Object.assign({parentName:"pre"},{className:"language-diff"}),"Accounts,\n-}\n+    Example,\n+}\n")),Object(a.c)("p",null,"Next, you need to register your ",Object(a.c)(c.l,{href:"architecture/singletons",mdxType:"Link"},"singleton"),". This will ensure configuration and state persistence."),Object(a.c)("h2",null,"Invocation"),Object(a.c)("p",null,"This is where things start to come together. Locate ",Object(a.c)("inlineCode",{parentName:"p"},"src/index.ts")," and open it. Inside here, you will find our root object. It is the home of our application container."),Object(a.c)("p",null,"The first step here is to register a ",Object(a.c)(c.l,{href:"architecture/singletons",mdxType:"Link"},"singleton"),' for your "Service" class.\nFind the ',Object(a.c)("inlineCode",{parentName:"p"},"boot")," method, and go to the bottom of that method. Here we are going to add a binding that the container will use to build a single instance of your class."),Object(a.c)("pre",null,Object(a.c)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),"this.singleton('services.example', (app: ContainerInterface, config: Config) => {\n    return new Services.Example(\n        config,\n        app.resolve('client')\n    );\n});\n")),Object(a.c)("p",null,"The counterpart to this registration is the resolution of its abstract definition; here ",Object(a.c)("inlineCode",{parentName:"p"},"'services.example'"),"."),Object(a.c)("p",null,"Near the bottom of the root ",Object(a.c)("inlineCode",{parentName:"p"},"Xedi")," class, add the following function."),Object(a.c)("pre",null,Object(a.c)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),"static get Example(): Services.Example\n{\n    return this.resolveInstance()\n        .resolve('services.example');\n}\n\n")),Object(a.c)("p",null,"Congratulations! You can now resolve you new class, statically. If you want, go ahead and jump into the ",Object(a.c)(c.l,{href:"tooling/debugging",mdxType:"Link"},"playground")," and type ",Object(a.c)("inlineCode",{parentName:"p"},"Xedi.Example"),". It should resolve you an instance of your new class and inside, you will find a ",Object(a.c)(c.l,{href:"architecture/config",mdxType:"Link"},"config bag")," and a ",Object(a.c)(c.l,{href:"architecture/http_requests",mdxType:"Link"},"HTTP client"),"."),Object(a.c)("h1",null,"Modifying API Classes"),Object(a.c)("p",null,"You want to start giving your class some abilities. Depending on your situation, you might be adding a series of CRUD endpoints, or something entirely different. In most cases, you will be sending requests to an instance of the XEDI API Gateway. Most endpoints are the same, but there will be a few caveats and edge-cases. Consider the following examples:"),Object(a.c)("pre",null,Object(a.c)("code",Object.assign({parentName:"pre"},{className:"language-typescript"}),"list() {\n    return this.client\n        .get<JsonResponse<Example>>(`1/examples`)\n        .then((response: AxiosResponse<JsonResponse<Example>>) => {\n            return response.data.data;\n        });\n}\n")),Object(a.c)(c.q,{as:"p",mt:2,mb:3,fontSize:1,color:"gray.5",mdxType:"Text"},"An indexing method"),Object(a.c)("p",null,"Lets look at line three of the above example. In JavaScript this would look like ",Object(a.c)(s.a,{mdxType:"InlineCode"},".get('1/examples')"),", so whats the extra stuff? This how we tell TypeScript, what we expect the ",Object(a.c)(c.l,{href:"architecture/http_requests",mdxType:"Link"},"HTTP Client")," to return in the promise. Here we tell it we want a ",Object(a.c)("inlineCode",{parentName:"p"},"JsonResponse")," which itself, must contain an ",Object(a.c)("inlineCode",{parentName:"p"},"Example"),"."),Object(a.c)(c.i,{varient:"info",mb:2,mdxType:"Flash"},Object(a.c)(c.q,{fontWeight:"bold",mdxType:"Text"},Object(a.c)(l.b,{mdxType:"InfoIcon"})," What is an ",Object(a.c)(s.a,{mdxType:"InlineCode"},"Example"),"?"),Object(a.c)("p",null,"In this instance, Example is a ",Object(a.c)(c.l,{href:"development/models",mdxType:"Link"},"model"),". A model is a simple definition of the data structure we expect. If you aren't familiar with this concept, read the section on ",Object(a.c)(c.l,{href:"development/models",mdxType:"Link"},"models"),".")),Object(a.c)("p",null,"On line four, we see that our response expectation is defined again, but this time within an ",Object(a.c)(c.l,{href:"architecture/http_requests",mdxType:"Link"},Object(a.c)(s.a,{mdxType:"InlineCode"},"AxiosResponse")),". Translated to plain english this reads: ",Object(a.c)(c.q,{as:"em",mdxType:"Text"},"Where ",Object(a.c)(s.a,{mdxType:"InlineCode"},"response")," is a JSON representation of a Example within an AxiosResponse"),". Again, at runtime, this compiles down to nothing, but here in TypeScript it helps us understand the intent of the code."))}m.isMDXComponent=!0},755:function(e,t,n){"use strict";var a=n(104),i=n(5),c=n(44),l=n(0),s=n.n(l),o=n(67),r=n(118),p=n(120),m=n(119);function u(e){var t=e.items,n=s.a.useContext(a.a),i=n.ul,c=void 0===i?"ul":i,l=n.li,o=void 0===l?"li":l,r=n.a,p=void 0===r?"a":r;return s.a.createElement(c,null,t.map(function(e){return s.a.createElement(o,{key:e.url},s.a.createElement(p,{href:e.url},e.title),e.items?s.a.createElement(u,{items:e.items}):null)}))}var d=function(e){var t=e.items,n=s.a.useContext(a.a).h2,i=void 0===n?"h2":n;return s.a.createElement(s.a.Fragment,null,s.a.createElement(i,null,"Table of contents"),s.a.createElement(u,{items:t}))},h=n(169);t.a=function(e){var t=e.children,n=e.pageContext,l=s.a.useContext(a.a).h1,u=void 0===l?"h1":l;return s.a.createElement(i.j,{flexDirection:"column",minHeight:"100vh"},s.a.createElement(r.a,{title:n.frontmatter.title,description:n.frontmatter.description}),s.a.createElement(p.a,null),s.a.createElement(i.j,{flex:"1 1 auto",flexDirection:"row"},s.a.createElement(i.e,{display:["none",null,null,"block"]},s.a.createElement(m.a,null)),s.a.createElement(o.a,null,s.a.createElement(u,null,n.frontmatter.title),n.frontmatter.status?s.a.createElement(i.e,{mb:4},s.a.createElement(h.a,{status:n.frontmatter.status})):null,n.tableOfContents.items?s.a.createElement(d,{items:n.tableOfContents.items}):null,t,n.editUrl?s.a.createElement(i.e,{my:6},s.a.createElement(i.l,{href:n.editUrl},s.a.createElement(i.p,{icon:c.e,mr:2}),"Edit this page on GitHub")):null)))}}}]);
//# sourceMappingURL=component---content-development-api-mdx-744921ce48fd339a2b74.js.map